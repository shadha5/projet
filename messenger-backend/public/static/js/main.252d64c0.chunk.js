(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{143:function(e,n,t){},145:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(26),s=t.n(c),u=t(33),o=t(5),i=t(66),p=t.n(i),f=t(99),d=function(e,n){var t=[];return e.forEach((function(e,r){if(e._id!==n.conversation)t.push(e);else{var a=e;a.messages.push(n),a.messages=f.unionBy(a.messages,"_id"),t.push(a)}})),f.sortBy(f.unionBy(t,"_id"),["updated"]).reverse()},l=function(e,n){var t=e;return t.push(n),f.sortBy(f.unionBy(t,"_id"),["updated"]).reverse()},b=function(e,n){var t=[];return e.forEach((function(e,r){e._id!==n._id?t.push(e):t.push(n)})),f.sortBy(f.unionBy(t,"_id"),["updated"]).reverse()},h=function(e,n){var t=e;return t.push(n),f.unionBy(t,"_id")},y=function(e,n){var t=[];return e.forEach((function(e,r){e._id!==n._id?t.push(e):t.push(n)})),f.unionBy(t,"_id")},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{person:{_id:null,image:null,username:null,first_name:null,last_name:null},contacts:[],conversations:[],brightness:"light",isLoggedIn:!1},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"CONTACT_UPDATED":return Object(o.a)(Object(o.a)({},e),{},{contacts:y(e.contacts,n.payload)});case"CONTACT_CREATED":return Object(o.a)(Object(o.a)({},e),{},{contacts:h(e.contacts,n.payload)});case"CONVERSATION_CREATED":return Object(o.a)(Object(o.a)({},e),{},{conversations:l(e.conversations,n.payload)});case"CONVERSATION_UPDATED":return Object(o.a)(Object(o.a)({},e),{},{conversations:b(e.conversations,n.payload)});case"PUSH_MESSAGE":return Object(o.a)(Object(o.a)({},e),{},{conversations:d(e.conversations,n.payload)});case"SET_CONVERSATIONS":return Object(o.a)(Object(o.a)({},e),{},{conversations:f.sortBy(f.unionBy(n.payload,"_id"),["updated"]).reverse()});case"SET_CONTACTS":return Object(o.a)(Object(o.a)({},e),{},{contacts:f.unionBy(n.payload,"_id")});case"SET_PERSON":return Object(o.a)(Object(o.a)({},e),{},{person:{_id:n.payload._id,image:n.payload.image,first_name:n.payload.first_name,last_name:n.payload.last_name}});case"SET_SNACKBAR":var t=[];return n.payload.isError?n.payload.errors.forEach((function(e){t.push({id:p()(),variant:"error",message:e.errorMessage,date:Date.now()})})):t.push({id:p()(),variant:"success",message:n.payload.message,date:Date.now()}),Object(o.a)(Object(o.a)({},e),{},{snackbars:t});case"CASE_RESET":return Object(o.a)(Object(o.a)({},{person:{_id:null,image:null,username:null,first_name:null,last_name:null},contacts:[],conversations:[],brightness:"light",isLoggedIn:!1}),{},{brightness:e.brightness});case"SET_BRIGHTNESS":return Object(o.a)(Object(o.a)({},e),{},{brightness:n.payload});case"SET_ISLOGGEDIN":return Object(o.a)(Object(o.a)({},e),{},{isLoggedIn:n.payload});default:return e}},O=Object(u.b)({AppReducers:j}),v=t(89),S=function(e){e&&e instanceof Function&&t.e(6).then(t.bind(null,452)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,s=n.getTTFB;t(e),r(e),a(e),c(e),s(e)}))},E=t(46),T=t(91),x=t(4),g=t.n(x),C=t(7),m=t(170),_=t(171),A=t(92),N=t.n(A),w=t(16),k=t(18),R=t(8),I=Object(r.lazy)((function(){return Promise.all([t.e(2),t.e(5)]).then(t.bind(null,471))})),B=Object(r.lazy)((function(){return t.e(4).then(t.bind(null,475))})),P=Object(E.b)((function(e){var n=e.AppReducers;return{brightness:n.brightness,isLoggedIn:n.isLoggedIn}}),(function(e){return{verifySession:function(){return e(Object(k.r)())},getConversations:function(){return e(Object(k.d)())},getContacts:function(){return e(Object(k.c)())},pushMessage:function(n){return e(Object(k.f)(n))},createConversation:function(n){return e(Object(k.b)(n))},updateConversation:function(n){return e(Object(k.q)(n))},createContact:function(n){return e(Object(k.a)(n))},updateContact:function(n){return e(Object(k.p)(n))},setContacts:function(n){return e(Object(k.j)(n))},setConversations:function(n){return e(Object(k.k)(n))}}}))((function(e){var n=e.pushMessage,t=e.brightness,c=(e.isLoggedIn,e.verifySession),s=e.getConversations,u=e.createConversation,o=e.updateConversation,i=e.createContact,p=e.updateContact,f=e.getContacts,d=e.setContacts,l=e.setConversations;return a.a.useEffect((function(){setTimeout(Object(C.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:return e.next=4,f();case 4:return e.next=6,c();case 6:(t=N()(w.b,{withCredentials:!0})).on("setContacts",(function(e){d(e)})),t.on("setConversations",(function(e){l(e)})),t.on("messageCreated",(function(e){n(e)})),t.on("conversationCreated",(function(e){u(e)})),t.on("conversationUpdated",(function(e){o(e)})),t.on("contactCreated",(function(e){i(e)})),t.on("contactUpdated",(function(e){p(e)}));case 14:case"end":return e.stop()}}),e)}))),0)})),Object(R.jsx)(r.Suspense,{fallback:Object(R.jsx)(m.a,{sx:{background:"light"===t?"#fff":"#121212"},open:!0,children:Object(R.jsx)(_.a,{sx:{cursor:"pointer",fontSize:"100px",color:"#3b5998"},component:"span",children:"\u05e9"})}),children:Object(R.jsx)(B,{brightness:t,children:Object(R.jsx)(I,{})})})})),D=(t(143),function(){try{var e=localStorage.getItem("shinState");if(null==e)return;return JSON.parse(e)}catch(n){return}}()),G=Object(u.d)(O,D,Object(u.c)(Object(u.a)(T.a)));G.subscribe((function(){!function(e){try{var n=JSON.stringify(e);localStorage.setItem("shinState",n)}catch(t){}}(G.getState())})),s.a.render(Object(R.jsx)(a.a.StrictMode,{children:Object(R.jsx)(E.a,{store:G,children:Object(R.jsx)(v.a,{children:Object(R.jsx)(P,{})})})}),document.getElementById("root")),S()},16:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return a}));var r="https://shin-messenger.herokuapp.com/api/v1",a="https://shin-messenger.herokuapp.com"},18:function(e,n,t){"use strict";t.d(n,"n",(function(){return o})),t.d(n,"l",(function(){return i})),t.d(n,"m",(function(){return p})),t.d(n,"r",(function(){return f})),t.d(n,"o",(function(){return d})),t.d(n,"d",(function(){return l})),t.d(n,"c",(function(){return b})),t.d(n,"e",(function(){return h})),t.d(n,"h",(function(){return y})),t.d(n,"g",(function(){return j})),t.d(n,"f",(function(){return O})),t.d(n,"b",(function(){return v})),t.d(n,"q",(function(){return S})),t.d(n,"a",(function(){return E})),t.d(n,"p",(function(){return T})),t.d(n,"j",(function(){return x})),t.d(n,"k",(function(){return g})),t.d(n,"i",(function(){return C}));var r=t(4),a=t.n(r),c=t(7),s=t(16),u=function(e,n){e.forEach((function(e){if("login"===e.requiredAction)n({type:"SET_ISLOGGEDIN",payload:!1}),n({type:"CASE_RESET"})}))},o=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){var r,c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(s.a+"/sign-up",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(e)});case 2:return r=n.sent,n.next=5,r.json();case 5:if(!(c=n.sent).success){n.next=11;break}t({type:"SET_ISLOGGEDIN",payload:!0}),t({type:"SET_SNACKBAR",payload:{isError:!1,message:c.message}}),n.next=14;break;case 11:return t({type:"SET_SNACKBAR",payload:{isError:!0,errors:c.errors}}),n.next=14,u(c.errors,t);case 14:return n.abrupt("return",c.success);case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},i=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){var r,c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(s.a+"/sign-in",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(e)});case 2:return r=n.sent,n.next=5,r.json();case 5:if(!(c=n.sent).success){n.next=11;break}t({type:"SET_ISLOGGEDIN",payload:!0}),t({type:"SET_SNACKBAR",payload:{isError:!1,message:c.message}}),n.next=14;break;case 11:return t({type:"SET_SNACKBAR",payload:{isError:!0,errors:c.errors}}),n.next=14,u(c.errors,t);case 14:return n.abrupt("return",c.success);case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},p=function(){return function(){var e=Object(c.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(s.a+"/sign-out",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:if(!(r=e.sent).success){e.next=11;break}n({type:"CASE_RESET"}),n({type:"SET_SNACKBAR",payload:{isError:!1,message:r.message}}),e.next=14;break;case 11:return n({type:"SET_SNACKBAR",payload:{isError:!0,errors:r.errors}}),e.next=14,u(r.errors,n);case 14:return e.abrupt("return",r.success);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},f=function(){return function(){var e=Object(c.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(s.a+"/session",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:if(!(r=e.sent).success){e.next=10;break}n({type:"SET_PERSON",payload:r.data}),e.next=12;break;case 10:return e.next=12,u(r.errors,n);case 12:return e.abrupt("return",r.success);case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},d=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){var r,c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(s.a+"/account",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),credentials:"include"});case 2:return r=n.sent,n.next=5,r.json();case 5:if(!(c=n.sent).success){n.next=11;break}t({type:"SET_PERSON",payload:c.data}),t({type:"SET_SNACKBAR",payload:{isError:!1,message:c.message}}),n.next=14;break;case 11:return n.next=13,u(c.errors,t);case 13:t({type:"SET_SNACKBAR",payload:{isError:!0,errors:c.errors}});case 14:return n.abrupt("return",c.success);case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},l=function(){return function(){var e=Object(c.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(s.a+"/conversations",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:if(!(r=e.sent).success){e.next=10;break}return e.abrupt("return",n({type:"SET_CONVERSATIONS",payload:r.data}));case 10:return e.next=12,u(r.errors,n);case 12:return e.abrupt("return",r.success);case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},b=function(){return function(){var e=Object(c.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(s.a+"/contacts",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:if(!(r=e.sent).success){e.next=10;break}return e.abrupt("return",n({type:"SET_CONTACTS",payload:r.data}));case 10:return e.next=12,u(r.errors,n);case 12:return e.abrupt("return",r.success);case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},h=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){var r,c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(s.a+"/persons/"+e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});case 2:return r=n.sent,n.next=5,r.json();case 5:if((c=n.sent).success){n.next=9;break}return n.next=9,u(c.errors,t);case 9:return n.abrupt("return",c);case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},y=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){var r,c;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(s.a+"/messages",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),credentials:"include"});case 2:return r=n.sent,n.next=5,r.json();case 5:if(!(c=n.sent).success){n.next=10;break}t({type:"PUSH_MESSAGE",payload:c.data}),n.next=12;break;case 10:return n.next=12,u(c.errors,t);case 12:return n.abrupt("return",c);case 13:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},j=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(s.a+"/search",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),credentials:"include"});case 2:return r=n.sent,n.next=5,r.json();case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},O=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"PUSH_MESSAGE",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},v=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"CONVERSATION_CREATED",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},S=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"CONVERSATION_UPDATED",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},E=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"CONTACT_CREATED",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},T=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"CONTACT_UPDATED",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},x=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"SET_CONTACTS",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},g=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"SET_CONVERSATIONS",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},C=function(e){return function(){var n=Object(c.a)(a.a.mark((function n(t){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t({type:"SET_BRIGHTNESS",payload:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}}},[[145,1,3]]]);
//# sourceMappingURL=main.252d64c0.chunk.js.map